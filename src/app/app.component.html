<!-- ========== THE EPONYMOUS GLOBAL TOOLTIP ========== -->
<app-tooltip></app-tooltip>

<!-- ========== NAVIGATION BAR ========== -->
<mat-toolbar color="primary" style="position: fixed; top: 0; height: 80px; z-index: 100;">
  <span style = "margin-left: 5%;"><h2>Steam Monkey</h2></span>
  <span class="spacer"></span>
  <form (submit)="$event.preventDefault()" style="margin-top: 20px">
    <mat-form-field>
      <mat-label>Game name</mat-label>
      <input matInput type="search" [formControl]="searchControl" [matAutocomplete]="auto">
      <mat-autocomplete #auto="matAutocomplete" panelWidth="500px"
                        [displayWith]="extractGameName"
                        (optionSelected)="onGameSelection($event.option.value)">
        <mat-option *ngFor="let game of filteredData | async" [value]="game">
          <span>{{game.name}}</span>
          <span class="spacer"></span>
          <img src="{{game.header_image}}" alt="Game image" style="height: 40px">
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>
  </form>
  <a href="https://store.steampowered.com/app/{{currentGame.appid}}" target="_blank">
    <img src="assets/icon.png" alt="Steam icon"  style="height: 30px; width: 30px; margin-left: 30px; ">
  </a>
</mat-toolbar>

<!-- CONTAINER FOR ENTIRE PAGE WITHOUT NAV BAR -->
<div style="width: 90%; margin-left: 5%; margin-right: 5%;">
  <!-- Clearance below nav bar -->
  <div style="height: 90px"></div>

  <div class="two-col-container">
    <div>
      <div #categoricalDataRadar></div>
    </div>
    <div>
      <div #categoricalDataBox></div>
    </div>
  </div>

  <div>
    <div #likesOverTimeLine></div>
  </div>

  <!-- ========== SINGLE GAME INFO ========== -->
  <!-- Header -->
  <mat-card class="game-card">
    <mat-card-header>
      <!-- WHY IS THIS IN REVERSE?!?!?!??!? IT REFUSES TO DISPLAY THEM IN THE RIGHT ORDER? -->
      <img mat-card-xl-image [attr.src]="currentGame.header_image" class="game-card-image" alt="Cover photo" />

      <mat-card-title #gameName><h2>{{currentGame.name}}</h2></mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <b>Genres</b>
      <mat-list #genreList>
        <mat-list-item *ngFor="let genre of currentGame.genre">{{genre}}</mat-list-item>
      </mat-list>
      <b>Categories</b>
      <mat-list #categoryList>
        <mat-list-item *ngFor="let category of currentGame.categories">{{category}}</mat-list-item>
      </mat-list>
      <b>Tags</b>
      <mat-list #tagList>
        <mat-list-item *ngFor="let tag of currentGame.tags | keyvalue">{{tag.key}}: {{tag.value}}</mat-list-item>
      </mat-list>
      <b>Languages</b>
      <mat-list #languageList>
        <mat-list-item *ngFor="let language of currentGame.languages.split(', ')">{{language}}</mat-list-item>
      </mat-list>
      <b>Platforms</b>
      <mat-list>
        <mat-list-item>
          <b>Windows: </b>
          <mat-icon #winSupport>{{supportToIconName(currentGame.platforms.windows)}}</mat-icon>
        </mat-list-item>
        <mat-list-item>
          <b>Linux: </b>
          <mat-icon #linuxSupport>{{supportToIconName(currentGame.platforms.windows)}}</mat-icon>
        </mat-list-item>
        <mat-list-item>
          <b>Mac: </b>
          <mat-icon #macSupport>{{supportToIconName(currentGame.platforms.windows)}}</mat-icon>
        </mat-list-item>
      </mat-list>
    </mat-card-content>
  </mat-card>

  <!-- First row -->
<!--  <div class="two-col-container">-->
<!--    <div>-->
<!--      <div #categoricalDataRadar></div>-->
<!--    </div>-->
<!--    <div>-->
<!--      <div #categoricalDataBox></div>-->
<!--    </div>-->

<!--    <app-radar instanceId="categoricalDataRadar" class="first-col"></app-radar>-->

<!--    <app-box instanceId="categoricalDataBox" class="second-col"></app-box>-->
<!--  </div>-->

  <!-- Second row -->
  <div class="two-col-container">
    <!-- TODO: Replace testing dummy with check of existence of Metacritic data once processing is complete -->
    <app-bar instanceId="scoresBar" class="first-col" *ngIf="hasMetaDummy; else steamReviewsPie"></app-bar>
    <ng-template #steamReviewsPie>
      <app-pie instanceId="steamReviewsPie" class="first-col"></app-pie>
    </ng-template>

    <app-pie instanceId="gameCompletionPie" class="second-col"></app-pie>
  </div>

  <!-- Third row -->
<!--  <div>-->
<!--    <div #likesOverTimeLine></div>-->
<!--  </div>-->

  <!-- Fourth row -->
  <div>
    <div #ccuOverTimeLine></div>
  </div>


  <!-- ========== MULTIPLE GAME INFO ========== -->
  <mat-divider></mat-divider>

  <!-- Numeric data correlation -->
  <div>
    <app-bin-scatter instanceId="numericDataBinScatter"></app-bin-scatter>
  </div>

  <!-- Genre count bar chart -->
  <div>
    <app-bar instanceId="genreCountBar"></app-bar>
  </div>

  <!-- Price brackets pie chart and placeholder -->
  <!-- TODO: Figure out something to put instead of the placeholder -->
  <div class="two-col-container">
    <app-pie instanceId="priceBracketsPie" class="first-col"></app-pie>

    <h3 class="second-col">PLACEHOLDER</h3>
  </div>


  <!-- ========== GENRE INFO ========== -->
  <mat-divider></mat-divider>

  <!-- Genre selector -->
  <div style="height: 20px"></div>
  <div style="margin: auto; width: 50%; text-align: center;">
    <mat-form-field appearance="fill" color="primary">
      <mat-label>{{currentGenre}}</mat-label>
      <mat-select (selectionChange)="onGenreSelection($event.value)">
        <mat-option *ngFor="let genre of currentGame.genre" [value]="genre">{{genre}}</mat-option>
      </mat-select>
      <mat-hint align="start">Select a genre</mat-hint>
    </mat-form-field>
  </div>

  <!-- Game release date timeline -->
  <div>
<!--    <app-line instanceId="gameReleaseLine"></app-line>-->
  </div>

  <div class="three-col-container">
<!--    <app-radar instanceId="genreCategoricalDataRadar" class="first-col"></app-radar>-->

<!--    <app-box instanceId="genreCategoricalDataBox" class="second-col"></app-box>-->

    <app-pie instanceId="genreCompletionPie" class="third-col"></app-pie>
  </div>

  <div>
<!--    <app-line instanceId="genreCcuLine"></app-line>-->
  </div>
</div>
